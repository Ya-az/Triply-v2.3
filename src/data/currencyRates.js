// Ø£Ø³Ø¹Ø§Ø± ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ù…Ù† Ø§Ù„Ø±ÙŠØ§Ù„ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ
// ÙŠØªÙ… ØªØ­Ø¯ÙŠØ«Ù‡Ø§ Ø¨Ø´ÙƒÙ„ Ø¯ÙˆØ±ÙŠ

export const currencyRates = {
  // Ø¨Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©
  'dubai': {
    currency: 'AED',
    symbol: 'Ø¯Ø±Ù‡Ù…',
    rate: 0.98,
    flag: 'ğŸ‡¦ğŸ‡ª'
  },
  'egypt': {
    currency: 'EGP',
    symbol: 'Ø¬Ù†ÙŠÙ‡',
    rate: 8.25,
    flag: 'ğŸ‡ªğŸ‡¬'
  },
  'paris': {
    currency: 'EUR',
    symbol: 'ÙŠÙˆØ±Ùˆ',
    rate: 0.24,
    flag: 'ğŸ‡«ğŸ‡·'
  },
  'london': {
    currency: 'GBP',
    symbol: 'Ø¬Ù†ÙŠÙ‡ Ø§Ø³ØªØ±Ù„ÙŠÙ†ÙŠ',
    rate: 0.21,
    flag: 'ğŸ‡¬ğŸ‡§'
  },
  'turkey': {
    currency: 'TRY',
    symbol: 'Ù„ÙŠØ±Ø©',
    rate: 7.85,
    flag: 'ğŸ‡¹ğŸ‡·'
  },
  // Ø¨Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„ÙƒØ§Ù…Ù„Ø©
  'Ø¯Ø¨ÙŠ - Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª': {
    currency: 'AED',
    symbol: 'Ø¯Ø±Ù‡Ù…',
    rate: 0.98,
    flag: 'ğŸ‡¦ğŸ‡ª'
  },
  'Ø¯Ø¨ÙŠ - Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ù…ØªØ­Ø¯Ø©': {
    currency: 'AED',
    symbol: 'Ø¯Ø±Ù‡Ù…',
    rate: 0.98,
    flag: 'ğŸ‡¦ğŸ‡ª'
  },
  'Ø§Ù„Ù‚Ø§Ù‡Ø±Ø© - Ù…ØµØ±': {
    currency: 'EGP',
    symbol: 'Ø¬Ù†ÙŠÙ‡',
    rate: 8.25,
    flag: 'ğŸ‡ªğŸ‡¬'
  },
  'Ø¨Ø§Ø±ÙŠØ³ - ÙØ±Ù†Ø³Ø§': {
    currency: 'EUR',
    symbol: 'ÙŠÙˆØ±Ùˆ',
    rate: 0.24,
    flag: 'ğŸ‡«ğŸ‡·'
  },
  'Ù„Ù†Ø¯Ù† - Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ù…ØªØ­Ø¯Ø©': {
    currency: 'GBP',
    symbol: 'Ø¬Ù†ÙŠÙ‡ Ø§Ø³ØªØ±Ù„ÙŠÙ†ÙŠ',
    rate: 0.21,
    flag: 'ğŸ‡¬ğŸ‡§'
  },
  'Ù„Ù†Ø¯Ù† - Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠØ§': {
    currency: 'GBP',
    symbol: 'Ø¬Ù†ÙŠÙ‡ Ø§Ø³ØªØ±Ù„ÙŠÙ†ÙŠ',
    rate: 0.21,
    flag: 'ğŸ‡¬ğŸ‡§'
  },
  'Ø¥Ø³Ø·Ù†Ø¨ÙˆÙ„ - ØªØ±ÙƒÙŠØ§': {
    currency: 'TRY',
    symbol: 'Ù„ÙŠØ±Ø©',
    rate: 7.85,
    flag: 'ğŸ‡¹ğŸ‡·'
  },
  'default': {
    currency: 'SAR',
    symbol: 'Ø±ÙŠØ§Ù„',
    rate: 1,
    flag: 'ğŸ‡¸ğŸ‡¦'
  }
};

// Ø¯Ø§Ù„Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ¬Ù‡Ø©
export const getCurrencyInfo = (destination) => {
  // Ø¥Ø°Ø§ ÙƒØ§Ù† destination Ø¹Ø¨Ø§Ø±Ø© Ø¹Ù† objectØŒ Ø§Ø³ØªØ®Ø±Ø¬ Ø§Ù„Ø§Ø³Ù…
  let destinationName = typeof destination === 'string' 
    ? destination 
    : destination?.name || destination?.destination || '';
  
  console.log('ğŸŒ Currency Info - Destination:', destination);
  console.log('ğŸ“ Destination Name:', destinationName);
  
  // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù†Øµ ÙˆØ¥Ø²Ø§Ù„Ø© Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª
  destinationName = destinationName.replace(/[ğŸ‡¦ğŸ‡ªğŸ‡ªğŸ‡¬ğŸ‡«ğŸ‡·ğŸ‡¬ğŸ‡§ğŸ‡¹ğŸ‡·]/g, '').trim();
  
  // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø¨Ø­Ø« Ø¨Ø·Ø±Ù‚ Ù…Ø®ØªÙ„ÙØ©
  let currencyInfo = currencyRates[destinationName];
  
  // Ø¥Ø°Ø§ Ù„Ù… ÙŠØ¬Ø¯ØŒ Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù†Øµ Ø¹Ù† ÙƒÙ„Ù…Ø§Øª Ù…ÙØªØ§Ø­ÙŠØ©
  if (!currencyInfo) {
    if (destinationName.includes('Ø¯Ø¨ÙŠ') || destinationName.includes('Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª') || destinationName.toLowerCase().includes('dubai')) {
      currencyInfo = currencyRates['dubai'];
    } else if (destinationName.includes('Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©') || destinationName.includes('Ù…ØµØ±') || destinationName.toLowerCase().includes('egypt') || destinationName.toLowerCase().includes('cairo')) {
      currencyInfo = currencyRates['egypt'];
    } else if (destinationName.includes('Ø¨Ø§Ø±ÙŠØ³') || destinationName.includes('ÙØ±Ù†Ø³Ø§') || destinationName.toLowerCase().includes('paris')) {
      currencyInfo = currencyRates['paris'];
    } else if (destinationName.includes('Ù„Ù†Ø¯Ù†') || destinationName.includes('Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠØ§') || destinationName.toLowerCase().includes('london')) {
      currencyInfo = currencyRates['london'];
    } else if (destinationName.includes('Ø¥Ø³Ø·Ù†Ø¨ÙˆÙ„') || destinationName.includes('ØªØ±ÙƒÙŠØ§') || destinationName.toLowerCase().includes('turkey') || destinationName.toLowerCase().includes('istanbul')) {
      currencyInfo = currencyRates['turkey'];
    }
  }
  
  console.log('ğŸ’± Found Currency:', currencyInfo);
  
  // Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©
  return currencyInfo || currencyRates['default'];
};

// Ø¯Ø§Ù„Ø© Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø¨Ù„Øº Ù…Ù† Ø§Ù„Ø±ÙŠØ§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ù…Ø­Ù„ÙŠØ©
export const convertCurrency = (amountInSAR, destination) => {
  const currencyInfo = getCurrencyInfo(destination);
  const convertedAmount = amountInSAR * currencyInfo.rate;
  
  return {
    amount: convertedAmount,
    currency: currencyInfo.currency,
    symbol: currencyInfo.symbol,
    flag: currencyInfo.flag,
    formatted: `${convertedAmount.toLocaleString('en-US', { 
      minimumFractionDigits: 0, 
      maximumFractionDigits: 0 
    })} ${currencyInfo.symbol}`
  };
};

// Ø¯Ø§Ù„Ø© Ù„Ø¹Ø±Ø¶ ÙƒÙ„Ø§ Ø§Ù„Ø³Ø¹Ø±ÙŠÙ† (Ø±ÙŠØ§Ù„ + Ø¹Ù…Ù„Ø© Ù…Ø­Ù„ÙŠØ©)
export const formatDualCurrency = (amountInSAR, destination) => {
  const currencyInfo = getCurrencyInfo(destination);
  
  // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø¹Ù…Ù„Ø© Ù‡ÙŠ Ø§Ù„Ø±ÙŠØ§Ù„ØŒ Ø£Ø¹Ø±Ø¶ Ø§Ù„Ø±ÙŠØ§Ù„ ÙÙ‚Ø·
  if (currencyInfo.currency === 'SAR') {
    return {
      primary: `${amountInSAR.toLocaleString('en-US')} Ø±ÙŠØ§Ù„`,
      secondary: null
    };
  }
  
  const converted = convertCurrency(amountInSAR, destination);
  
  return {
    primary: `${amountInSAR.toLocaleString('en-US')} Ø±ÙŠØ§Ù„`,
    secondary: `${converted.flag} ${converted.formatted}`
  };
};
